# Gemini版 - JTBCサポートデスク チャットボット

**最適なコスト構成：ベクトル化は完全無料、回答生成のみ無料枠を使用**

## 💰 コスト詳細

| 項目 | 使用技術 | コスト |
|------|----------|--------|
| **ベクトル化（Embeddings）** | HuggingFace | **完全無料・無制限** ✨ |
| **質問回答（LLM）** | Google Gemini | **無料枠60回/月** |
| **合計** | - | **実質無料** 🎉 |

### 💡 重要ポイント

- ✅ **初期セットアップ（118件のベクトル化）は無料枠を消費しません！**
- ✅ **定期更新のベクトル化も無料枠を消費しません！**
- ⚠️ **チャットで質問に回答する時だけ、Geminiの無料枠を消費します**

### 📊 使用量の目安

1日の質問数で計算：
- **1日1回の質問** → 月30回 → **完全に無料枠内** ✅
- **1日2回の質問** → 月60回 → **完全に無料枠内** ✅
- **1日3回以上** → 月90回以上 → 有料プラン必要

## 🚀 セットアップ

### 1. Google Gemini APIキーを取得

1. https://makersuite.google.com/app/apikey にアクセス
2. 「Create API Key」をクリック
3. APIキーをコピー

**無料枠:** 60リクエスト/分、無料

### 2. 依存関係のインストール

```bash
pip install -r requirements-gemini.txt
```

### 3. 環境変数の設定

```bash
cp .env.example.gemini .env
```

`.env`ファイルを編集：
```env
GEMINI_API_KEY=your-actual-api-key-here
GEMINI_MODEL=gemini-pro
```

### 4. 初期セットアップ（ベクトル化）

```bash
python setup_gemini.py
```

**この処理は無料枠を消費しません！** ✨
- HuggingFaceのEmbeddingsを使用
- 完全にローカルで処理
- 118件全てベクトル化しても$0

### 5. アプリケーション起動

```bash
python app_gemini.py
```

ブラウザで `http://localhost:5000` を開く

## 📝 使用例

### 質問1回につき1リクエスト消費

```
ユーザー: 「総務省への届出について教えてください」
→ Gemini APIを1回呼び出し（無料枠: 59/60残）
```

### ベクトル検索は無料

システムは以下の処理を無料で実行：
1. 質問をベクトル化（HuggingFace - 無料）
2. 類似記事を検索（ローカル - 無料）
3. 関連記事を取得（ローカル - 無料）
4. Geminiに送信して回答生成（**ここだけ1リクエスト消費**）

## 🎯 他の版との比較

| 版 | Embeddings | LLM | 初期コスト | 月額コスト |
|----|-----------|-----|----------|----------|
| **Gemini版（これ）** | 無料 | 無料枠 | **$0** | **$0** ✨ |
| 完全無料版 | 無料 | Ollama | $0 | $0 |
| OpenAI版 | 有料 | 有料 | ~$0.50 | $5-50 |

## 🔄 バージョン切り替え

### Gemini版（このバージョン）
```bash
python setup_gemini.py
python app_gemini.py
```

### 完全無料版（Ollama）
```bash
python setup_free.py
python app_free.py
```

### OpenAI版
```bash
python setup.py
python app.py
```

## 💡 推奨される使い方

### 個人使用・テスト環境
→ **Gemini版（このバージョン）が最適** ✨
- ベクトル化が完全無料
- 1日2回まで質問可能
- セットアップが簡単

### 大量使用・本番環境
→ **完全無料版（Ollama）**
- 完全無制限
- PCスペックが必要

### 高品質が必要
→ **OpenAI版**
- 最高品質の回答
- コストがかかる

## 🔧 トラブルシューティング

### APIキーエラー
```
Error: GEMINI_API_KEY not found
```
→ `.env`ファイルにAPIキーを設定

### 無料枠を使い切った
```
Error: Quota exceeded
```
→ 翌月まで待つ、またはOllama版に切り替え

### 日本語の回答品質
Geminiは日本語に非常に強いです。OpenAIと同等以上の品質が期待できます。

## 🎉 まとめ

**Gemini版の最大の利点：**
- ✅ 初期ベクトル化（118件）が完全無料
- ✅ 定期更新も無料
- ✅ 実際の質問回答のみ無料枠を使用
- ✅ 1日2回の質問なら完全に無料枠内
- ✅ 日本語の回答品質が高い

**あなたの懸念（118件のベクトル化で無料枠消費）は完全に解決されました！** 🎊
